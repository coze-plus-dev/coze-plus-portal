# Coze Plus ä»£ç ç»“æ„æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ Coze Plus é¡¹ç›®çš„ä»£ç ç»„ç»‡ç»“æ„ã€æ¨¡å—åˆ’åˆ†ã€ä¾èµ–å…³ç³»å’Œå¼€å‘è§„èŒƒã€‚é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå‰ç«¯ä½¿ç”¨ Rush.js monorepo ç®¡ç†ï¼Œåç«¯é‡‡ç”¨ DDD é¢†åŸŸé©±åŠ¨è®¾è®¡ã€‚

## ğŸ—ï¸ æ•´ä½“ä»£ç ç»“æ„

```
coze-plus/
â”œâ”€â”€ ğŸ“ frontend/                    # å‰ç«¯ä»£ç  (TypeScript + React)
â”œâ”€â”€ ğŸ“ backend/                     # åç«¯ä»£ç  (Go + Hertz)
â”œâ”€â”€ ğŸ“ idl/                         # æ¥å£å®šä¹‰è¯­è¨€ (Thrift)
â”œâ”€â”€ ğŸ“ docker/                      # å®¹å™¨é…ç½®
â”œâ”€â”€ ğŸ“ scripts/                     # æ„å»ºè„šæœ¬
â”œâ”€â”€ ğŸ“ docs/                        # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ ğŸ“ common/                      # é€šç”¨é…ç½®
â”œâ”€â”€ ğŸ“„ rush.json                    # Rush.js é…ç½®
â”œâ”€â”€ ğŸ“„ Makefile                     # æ„å»ºå‘½ä»¤
â””â”€â”€ ğŸ“„ CLAUDE.md                    # å¼€å‘æŒ‡å—
```

## ğŸ¨ å‰ç«¯ä»£ç ç»“æ„

### Rush.js Monorepo æ¶æ„

å‰ç«¯é‡‡ç”¨ Rush.js ç®¡ç†çš„ monorepo æ¶æ„ï¼ŒåŒ…å« 135+ ä¸ªåŒ…ï¼Œåˆ†ä¸º 4 ä¸ªä¾èµ–å±‚çº§ï¼š

```
frontend/
â”œâ”€â”€ ğŸ“ apps/                        # Level 4: åº”ç”¨å±‚
â”‚   â””â”€â”€ ğŸ“ coze-studio/             # ä¸»åº”ç”¨å…¥å£
â”‚       â”œâ”€â”€ ğŸ“„ package.json
â”‚       â”œâ”€â”€ ğŸ“„ rsbuild.config.ts    # Rsbuild æ„å»ºé…ç½®
â”‚       â”œâ”€â”€ ğŸ“„ tsconfig.json
â”‚       â”œâ”€â”€ ğŸ“ src/
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ index.tsx        # åº”ç”¨å…¥å£
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ App.tsx          # æ ¹ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ ğŸ“ pages/           # é¡µé¢ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ ğŸ“ components/      # åº”ç”¨çº§ç»„ä»¶
â”‚       â”‚   â””â”€â”€ ğŸ“ hooks/           # åº”ç”¨çº§Hooks
â”‚       â””â”€â”€ ğŸ“ public/              # é™æ€èµ„æº
â”œâ”€â”€ ğŸ“ packages/                    # Level 1-3: åŒ…å±‚
â”‚   â”œâ”€â”€ ğŸ“ arch/                    # Level 1: æ¶æ„å±‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ eslint-config/       # ESLint é…ç½®åŒ…
â”‚   â”‚   â”œâ”€â”€ ğŸ“ ts-config/           # TypeScript é…ç½®åŒ…
â”‚   â”‚   â”œâ”€â”€ ğŸ“ idl/                 # IDL æ¥å£ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ ğŸ“ utils/               # æ¶æ„çº§å·¥å…·
â”‚   â”œâ”€â”€ ğŸ“ common/                  # Level 2: é€šç”¨å±‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/          # é€šç”¨UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“ hooks/               # é€šç”¨React Hooks
â”‚   â”‚   â”œâ”€â”€ ğŸ“ services/            # é€šç”¨ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“ utils/               # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ ğŸ“ stores/              # å…¨å±€çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ ğŸ“ data/                    # Level 3: æ•°æ®å±‚
â”‚   â”‚   â””â”€â”€ ğŸ“ knowledge/           # çŸ¥è¯†åº“æ•°æ®åŒ…
â”‚   â”‚       â”œâ”€â”€ ğŸ“ common/          # çŸ¥è¯†åº“é€šç”¨ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ ğŸ“ knowledge-ide-base/           # IDEåŸºç¡€åŒ…
â”‚   â”‚       â”œâ”€â”€ ğŸ“ knowledge-ide-adapter/        # IDEé€‚é…å™¨åŒ…
â”‚   â”‚       â”œâ”€â”€ ğŸ“ knowledge-modal-base/         # æ¨¡æ€æ¡†åŸºç¡€åŒ…
â”‚   â”‚       â”œâ”€â”€ ğŸ“ knowledge-modal-adapter/      # æ¨¡æ€æ¡†é€‚é…å™¨åŒ…
â”‚   â”‚       â”œâ”€â”€ ğŸ“ knowledge-resource-processor-core/     # èµ„æºå¤„ç†å™¨æ ¸å¿ƒ
â”‚   â”‚       â”œâ”€â”€ ğŸ“ knowledge-resource-processor-base/     # èµ„æºå¤„ç†å™¨åŸºç¡€
â”‚   â”‚       â””â”€â”€ ğŸ“ knowledge-resource-processor-adapter/  # èµ„æºå¤„ç†å™¨é€‚é…å™¨
â”‚   â”œâ”€â”€ ğŸ“ studio/                  # Level 3: å·¥ä½œå®¤åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ ğŸ“ workspace/           # å·¥ä½œç©ºé—´
â”‚   â”‚   â”œâ”€â”€ ğŸ“ agent/               # AIä»£ç†
â”‚   â”‚   â””â”€â”€ ğŸ“ settings/            # è®¾ç½®
â”‚   â””â”€â”€ ğŸ“ workflow/                # Level 3: å·¥ä½œæµ
â”‚       â”œâ”€â”€ ğŸ“ editor/              # å·¥ä½œæµç¼–è¾‘å™¨
â”‚       â”œâ”€â”€ ğŸ“ nodes/               # å·¥ä½œæµèŠ‚ç‚¹
â”‚       â””â”€â”€ ğŸ“ runner/              # å·¥ä½œæµæ‰§è¡Œå™¨
â”œâ”€â”€ ğŸ“ config/                      # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ ğŸ“ eslint-config/           # ESLint é…ç½®
â”‚   â”œâ”€â”€ ğŸ“ ts-config/               # TypeScript é…ç½®
â”‚   â”œâ”€â”€ ğŸ“ rsbuild/                 # Rsbuild é…ç½®
â”‚   â””â”€â”€ ğŸ“ stylelint/               # Stylelint é…ç½®
â”œâ”€â”€ ğŸ“ infra/                       # åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ ğŸ“ build-tools/             # æ„å»ºå·¥å…·
â”‚   â”œâ”€â”€ ğŸ“ dev-tools/               # å¼€å‘å·¥å…·
â”‚   â””â”€â”€ ğŸ“ testing/                 # æµ‹è¯•å·¥å…·
â””â”€â”€ ğŸ“ scripts/                     # è„šæœ¬æ–‡ä»¶
    â”œâ”€â”€ ğŸ“„ build.js                 # æ„å»ºè„šæœ¬
    â”œâ”€â”€ ğŸ“„ dev.js                   # å¼€å‘è„šæœ¬
    â””â”€â”€ ğŸ“„ test.js                  # æµ‹è¯•è„šæœ¬
```

### å‰ç«¯åŒ…å‘½åè§„èŒƒ

| åŒ…ç±»å‹ | å‘½åè§„èŒƒ | ç¤ºä¾‹ | è¯´æ˜ |
|--------|----------|------|------|
| **æ¶æ„å±‚** | `@coze-arch/*` | `@coze-arch/eslint-config` | åŸºç¡€æ¶æ„é…ç½® |
| **é€šç”¨å±‚** | `@coze-common/*` | `@coze-common/components` | é€šç”¨ç»„ä»¶åº“ |
| **æ•°æ®å±‚** | `@coze-data/*` | `@coze-data/knowledge` | æ•°æ®æœåŠ¡ |
| **å·¥ä½œå®¤** | `@coze-studio/*` | `@coze-studio/workspace` | å·¥ä½œå®¤åŠŸèƒ½ |
| **å·¥ä½œæµ** | `@coze-workflow/*` | `@coze-workflow/editor` | å·¥ä½œæµç›¸å…³ |
| **åº”ç”¨å±‚** | `@coze-apps/*` | `@coze-apps/studio` | åº”ç”¨å…¥å£ |

### çŸ¥è¯†åº“æ¨¡å—è¯¦ç»†ç»“æ„

```
packages/data/knowledge/
â”œâ”€â”€ ğŸ“ common/                      # é€šç”¨åŸºç¡€ (Level 1)
â”‚   â”œâ”€â”€ ğŸ“„ package.json
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/          # åŸºç¡€UIç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ KnowledgeCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DocumentViewer.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ SearchInput.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“ hooks/               # åŸºç¡€Hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ useKnowledge.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ useDocument.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ useSearch.ts
â”‚   â”‚   â”œâ”€â”€ ğŸ“ types/               # ç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ knowledge.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ document.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ search.ts
â”‚   â”‚   â””â”€â”€ ğŸ“ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ formatters.ts
â”‚   â”‚       â””â”€â”€ ğŸ“„ validators.ts
â”‚   â””â”€â”€ ğŸ“„ index.ts                 # å¯¼å‡ºå…¥å£
â”œâ”€â”€ ğŸ“ knowledge-resource-processor-core/    # æ ¸å¿ƒå¤„ç†å™¨ (Level 2)
â”‚   â”œâ”€â”€ ğŸ“„ package.json
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ processors/          # æ–‡æ¡£å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ TextProcessor.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PDFProcessor.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ ImageProcessor.ts
â”‚   â”‚   â”œâ”€â”€ ğŸ“ chunkers/            # åˆ†å—å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ TextChunker.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ SemanticChunker.ts
â”‚   â”‚   â””â”€â”€ ğŸ“ embeddings/          # å‘é‡åŒ–
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ EmbeddingService.ts
â”‚   â”‚       â””â”€â”€ ğŸ“„ VectorStore.ts
â”‚   â””â”€â”€ ğŸ“„ index.ts
â”œâ”€â”€ ğŸ“ knowledge-resource-processor-base/     # å¤„ç†å™¨åŸºç¡€ (Level 2)
â”‚   â”œâ”€â”€ ğŸ“„ package.json
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/          # å¤„ç†å™¨UIç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ ProcessorStatus.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ ProgressBar.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ ErrorDisplay.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“ hooks/               # å¤„ç†å™¨Hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ useProcessor.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ useProgress.ts
â”‚   â”‚   â””â”€â”€ ğŸ“ services/            # å¤„ç†å™¨æœåŠ¡
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ ProcessorAPI.ts
â”‚   â”‚       â””â”€â”€ ğŸ“„ QueueManager.ts
â”‚   â””â”€â”€ ğŸ“„ index.ts
â”œâ”€â”€ ğŸ“ knowledge-resource-processor-adapter/  # å¤„ç†å™¨é€‚é…å™¨ (Level 3)
â”‚   â”œâ”€â”€ ğŸ“„ package.json
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ adapters/            # ä¸šåŠ¡é€‚é…å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ WorkspaceAdapter.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ AgentAdapter.ts
â”‚   â”‚   â”œâ”€â”€ ğŸ“ integrations/        # ç¬¬ä¸‰æ–¹é›†æˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ S3Integration.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ WebDAVIntegration.ts
â”‚   â”‚   â””â”€â”€ ğŸ“ workflows/           # å·¥ä½œæµé›†æˆ
â”‚   â”‚       â””â”€â”€ ğŸ“„ ProcessorWorkflow.ts
â”‚   â””â”€â”€ ğŸ“„ index.ts
â”œâ”€â”€ ğŸ“ knowledge-ide-base/          # IDEåŸºç¡€ (Level 3)
â”‚   â”œâ”€â”€ ğŸ“„ package.json
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/          # IDEç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ KnowledgeExplorer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DocumentEditor.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ SearchPanel.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“ layouts/             # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ IDELayout.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ PanelLayout.tsx
â”‚   â”‚   â””â”€â”€ ğŸ“ contexts/            # React Context
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ IDEContext.tsx
â”‚   â”‚       â””â”€â”€ ğŸ“„ SelectionContext.tsx
â”‚   â””â”€â”€ ğŸ“„ index.ts
â”œâ”€â”€ ğŸ“ knowledge-ide-adapter/       # IDEé€‚é…å™¨ (Level 3)
â”‚   â”œâ”€â”€ ğŸ“„ package.json
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ adapters/            # ä¸šåŠ¡åœºæ™¯é€‚é…
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ AgentIDEAdapter.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ WorkflowIDEAdapter.ts
â”‚   â”‚   â”œâ”€â”€ ğŸ“ plugins/             # IDEæ’ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ SearchPlugin.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ PreviewPlugin.ts
â”‚   â”‚   â””â”€â”€ ğŸ“ shortcuts/           # å¿«æ·é”®
â”‚   â”‚       â””â”€â”€ ğŸ“„ KeyboardShortcuts.ts
â”‚   â””â”€â”€ ğŸ“„ index.ts
â”œâ”€â”€ ğŸ“ knowledge-modal-base/        # æ¨¡æ€æ¡†åŸºç¡€ (Level 3)
â”‚   â”œâ”€â”€ ğŸ“„ package.json
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/          # æ¨¡æ€æ¡†ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ KnowledgeModal.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DocumentModal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ SearchModal.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“ hooks/               # æ¨¡æ€æ¡†Hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ useModal.ts
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ useModalState.ts
â”‚   â”‚   â””â”€â”€ ğŸ“ providers/           # çŠ¶æ€æä¾›è€…
â”‚   â”‚       â””â”€â”€ ğŸ“„ ModalProvider.tsx
â”‚   â””â”€â”€ ğŸ“„ index.ts
â”œâ”€â”€ ğŸ“ knowledge-modal-adapter/     # æ¨¡æ€æ¡†é€‚é…å™¨ (Level 3)
â”‚   â”œâ”€â”€ ğŸ“„ package.json
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ modals/              # ä¸šåŠ¡æ¨¡æ€æ¡†
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ CreateKnowledgeModal.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ UploadDocumentModal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ SettingsModal.tsx
â”‚   â”‚   â””â”€â”€ ğŸ“ flows/               # æ¨¡æ€æ¡†æµç¨‹
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ OnboardingFlow.tsx
â”‚   â”‚       â””â”€â”€ ğŸ“„ ImportFlow.tsx
â”‚   â””â”€â”€ ğŸ“„ index.ts
â””â”€â”€ ğŸ“ knowledge-data-set-for-agent/ # Agentæ•°æ®é›† (Level 3)
    â”œâ”€â”€ ğŸ“„ package.json
    â”œâ”€â”€ ğŸ“ src/
    â”‚   â”œâ”€â”€ ğŸ“ components/          # Agentä¸“ç”¨ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ ğŸ“„ AgentKnowledgePanel.tsx
    â”‚   â”‚   â””â”€â”€ ğŸ“„ KnowledgeSelector.tsx
    â”‚   â”œâ”€â”€ ğŸ“ hooks/               # Agentä¸“ç”¨Hooks
    â”‚   â”‚   â”œâ”€â”€ ğŸ“„ useAgentKnowledge.ts
    â”‚   â”‚   â””â”€â”€ ğŸ“„ useKnowledgeBinding.ts
    â”‚   â””â”€â”€ ğŸ“ services/            # Agentæ•°æ®æœåŠ¡
    â”‚       â”œâ”€â”€ ğŸ“„ AgentKnowledgeService.ts
    â”‚       â””â”€â”€ ğŸ“„ BindingService.ts
    â””â”€â”€ ğŸ“„ index.ts
```

### å‰ç«¯åŒ…ä¾èµ–å…³ç³»

```mermaid
graph TD
    subgraph "Level 4: Apps"
        A[coze-studio]
    end

    subgraph "Level 3: Domain"
        B[knowledge-ide-adapter]
        C[knowledge-modal-adapter]
        D[knowledge-resource-processor-adapter]
        E[studio/workspace]
        F[workflow/editor]
    end

    subgraph "Level 2: Common"
        G[knowledge-ide-base]
        H[knowledge-modal-base]
        I[knowledge-resource-processor-base]
        J[common/components]
        K[common/hooks]
    end

    subgraph "Level 1: Architecture"
        L[knowledge-resource-processor-core]
        M[knowledge/common]
        N[arch/utils]
        O[arch/eslint-config]
    end

    A --> B
    A --> C
    A --> D
    A --> E
    A --> F

    B --> G
    C --> H
    D --> I
    B --> J
    C --> J
    D --> J

    G --> L
    H --> M
    I --> L
    J --> N
    K --> N

    L --> O
    M --> O
    N --> O
```

## ğŸš€ åç«¯ä»£ç ç»“æ„

### DDD é¢†åŸŸé©±åŠ¨è®¾è®¡æ¶æ„

åç«¯é‡‡ç”¨ DDD (Domain-Driven Design) æ¶æ„ï¼Œæ¸…æ™°åˆ†ç¦»ä¸šåŠ¡é€»è¾‘ï¼š

```
backend/
â”œâ”€â”€ ğŸ“ api/                         # API æ¥å£å±‚
â”‚   â”œâ”€â”€ ğŸ“ handler/                 # HTTP å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ ğŸ“ coze/                # Coze ä¸šåŠ¡å¤„ç†å™¨ (ç»Ÿä¸€åœ¨æ­¤ç›®å½•)
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ knowledge_service.go    # çŸ¥è¯†åº“æœåŠ¡æ¥å£
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ agent_run_service.go    # æ™ºèƒ½ä½“è¿è¡ŒæœåŠ¡æ¥å£
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ bot_open_api_service.go # Bot OpenAPI æ¥å£
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ workflow_service.go     # å·¥ä½œæµæœåŠ¡æ¥å£
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ developer_api_service.go # å¼€å‘è€… API æ¥å£
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ playground_service.go    # Playground æ¥å£
â”‚   â”‚       â””â”€â”€ ğŸ“„ channel_service.go       # æ¸ é“æœåŠ¡æ¥å£
â”‚   â”œâ”€â”€ ğŸ“ middleware/              # ä¸­é—´ä»¶ (ç‹¬ç«‹ç›®å½•)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ session.go                  # Session è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ openapi_auth.go             # OpenAPI è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ request_inspector.go        # è¯·æ±‚æ£€æµ‹ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ permission.go               # æƒé™æ£€æŸ¥ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ ğŸ“„ cors.go                     # è·¨åŸŸä¸­é—´ä»¶
â”‚   â”œâ”€â”€ ğŸ“ model/                   # API æ•°æ®æ¨¡å‹ (Thrift ç”Ÿæˆ)
â”‚   â”‚   â”œâ”€â”€ ğŸ“ knowledge/           # çŸ¥è¯†åº“APIæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ ğŸ“ app/                 # åº”ç”¨APIæ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ bot_common/            # Bot é€šç”¨æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ bot_open_api/          # Bot OpenAPI æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ developer_api/         # å¼€å‘è€… API æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ ğŸ“ conversation/        # å¯¹è¯APIæ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ run/                   # è¿è¡Œæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ ğŸ“ workflow/            # å·¥ä½œæµAPIæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ ğŸ“ channel/             # æ¸ é“APIæ¨¡å‹
â”‚   â”‚   â””â”€â”€ ğŸ“ base/                # åŸºç¡€æ¨¡å‹
â”‚   â”œâ”€â”€ ğŸ“ router/                  # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ ğŸ“ coze/                # Coze è·¯ç”±
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ api.go                  # API è·¯ç”±æ³¨å†Œ
â”‚   â”‚       â””â”€â”€ ğŸ“„ middleware.go           # ä¸­é—´ä»¶é…ç½®
â”‚   â””â”€â”€ ğŸ“ internal/                # API å†…éƒ¨å·¥å…·
â”‚       â””â”€â”€ ğŸ“ httputil/            # HTTP å·¥å…·å‡½æ•°
â”œâ”€â”€ ğŸ“ application/                 # åº”ç”¨æœåŠ¡å±‚
â”‚   â”œâ”€â”€ ğŸ“ app/                     # åº”ç”¨ç®¡ç†
â”‚   â”œâ”€â”€ ğŸ“ channel/                 # æ¸ é“åº”ç”¨æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ conversation/            # å¯¹è¯åº”ç”¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ agent_run.go                # æ™ºèƒ½ä½“è¿è¡Œ
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ message.go                  # æ¶ˆæ¯ç®¡ç†
â”‚   â”‚   â””â”€â”€ ğŸ“„ openapi_agent_run.go        # OpenAPI æ™ºèƒ½ä½“è¿è¡Œ
â”‚   â”œâ”€â”€ ğŸ“ knowledge/               # çŸ¥è¯†åº“åº”ç”¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ knowledge.go                # çŸ¥è¯†åº“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ convertor.go                # è½¬æ¢å™¨
â”‚   â”‚   â””â”€â”€ ğŸ“„ knowledge_test.go           # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ ğŸ“ memory/                  # è®°å¿†åº”ç”¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ database.go                 # æ•°æ®åº“æœåŠ¡
â”‚   â”‚   â””â”€â”€ ğŸ“„ variables.go                # å˜é‡æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ plugin/                  # æ’ä»¶åº”ç”¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ plugin.go                   # æ’ä»¶æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ api_management.go           # API ç®¡ç†
â”‚   â”‚   â””â”€â”€ ğŸ“„ lifecycle.go                # ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â”œâ”€â”€ ğŸ“ singleagent/             # å•æ™ºèƒ½ä½“åº”ç”¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ single_agent.go             # å•æ™ºèƒ½ä½“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ create.go                   # åˆ›å»ºæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ publish.go                  # å‘å¸ƒæœåŠ¡
â”‚   â”‚   â””â”€â”€ ğŸ“„ get.go                      # è·å–æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ user/                    # ç”¨æˆ·åº”ç”¨æœåŠ¡
â”‚   â””â”€â”€ ğŸ“ workflow/                # å·¥ä½œæµåº”ç”¨æœåŠ¡
â”‚       â”œâ”€â”€ ğŸ“„ workflow.go                 # å·¥ä½œæµæœåŠ¡
â”‚       â”œâ”€â”€ ğŸ“„ chatflow.go                 # ChatFlow æœåŠ¡
â”‚       â””â”€â”€ ğŸ“„ chatflow_test.go            # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ ğŸ“ domain/                      # é¢†åŸŸå±‚ (DDD è®¾è®¡)
â”‚   â”œâ”€â”€ ğŸ“ agent/                   # å•æ™ºèƒ½ä½“é¢†åŸŸ
â”‚   â”‚   â””â”€â”€ ğŸ“ singleagent/         # å•æ™ºèƒ½ä½“å­åŸŸ
â”‚   â”‚       â”œâ”€â”€ ğŸ“ entity/              # é¢†åŸŸå®ä½“
â”‚   â”‚       â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“ agentflow/           # æ™ºèƒ½ä½“æµç¨‹
â”‚   â”‚       â”‚   â””â”€â”€ ğŸ“ dal/                 # æ•°æ®è®¿é—®å±‚
â”‚   â”‚       â””â”€â”€ ğŸ“ service/             # é¢†åŸŸæœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ app/                     # åº”ç”¨é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # åº”ç”¨å®ä½“
â”‚   â”‚   â””â”€â”€ ğŸ“ service/             # åº”ç”¨æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ channel/                 # æ¸ é“é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # æ¸ é“å®ä½“
â”‚   â”‚   â”œâ”€â”€ ğŸ“ service/             # æ¸ é“æœåŠ¡
â”‚   â”‚   â””â”€â”€ ğŸ“ repository/          # ä»“å‚¨æ¥å£
â”‚   â”œâ”€â”€ ğŸ“ conversation/            # å¯¹è¯é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ agentrun/            # æ™ºèƒ½ä½“è¿è¡Œ
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # è¿è¡Œå®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ service/             # è¿è¡ŒæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“ conversation/        # ä¼šè¯ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # ä¼šè¯å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ service/             # ä¼šè¯æœåŠ¡
â”‚   â”‚   â””â”€â”€ ğŸ“ message/             # æ¶ˆæ¯ç®¡ç†
â”‚   â”‚       â”œâ”€â”€ ğŸ“ entity/              # æ¶ˆæ¯å®ä½“
â”‚   â”‚       â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚   â”‚       â”œâ”€â”€ ğŸ“ repository/          # ä»“å‚¨æ¥å£
â”‚   â”‚       â””â”€â”€ ğŸ“ service/             # æ¶ˆæ¯æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ knowledge/               # çŸ¥è¯†åº“é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # é¢†åŸŸå®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ knowledge.go            # çŸ¥è¯†åº“å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ document.go             # æ–‡æ¡£å®ä½“
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ slice.go                # æ–‡æ¡£åˆ‡ç‰‡å®ä½“
â”‚   â”‚   â”œâ”€â”€ ğŸ“ processor/           # æ–‡æ¡£å¤„ç†å™¨
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ impl/                # å¤„ç†å™¨å®ç°
â”‚   â”‚   â”œâ”€â”€ ğŸ“ repository/          # ä»“å‚¨æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“ service/             # é¢†åŸŸæœåŠ¡
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ knowledge.go            # çŸ¥è¯†åº“æœåŠ¡
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ retrieve.go             # æ£€ç´¢æœåŠ¡
â”‚   â”‚       â””â”€â”€ ğŸ“„ sheet.go                # è¡¨æ ¼æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ memory/                  # è®°å¿†é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ database/            # æ•°æ®åº“è®°å¿†
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # æ•°æ®åº“å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ repository/          # ä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ service/             # æ•°æ®åº“æœåŠ¡
â”‚   â”‚   â””â”€â”€ ğŸ“ variables/           # å˜é‡è®°å¿†
â”‚   â”‚       â”œâ”€â”€ ğŸ“ entity/              # å˜é‡å®ä½“
â”‚   â”‚       â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚   â”‚       â””â”€â”€ ğŸ“ repository/          # ä»“å‚¨æ¥å£
â”‚   â”œâ”€â”€ ğŸ“ permission/              # æƒé™é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # æƒé™å®ä½“
â”‚   â”‚   â”œâ”€â”€ ğŸ“ repository/          # ä»“å‚¨æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“ service/             # æƒé™æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ plugin/                  # æ’ä»¶é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ dto/                 # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # æ’ä»¶å®ä½“
â”‚   â”‚   â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚   â”‚   â”œâ”€â”€ ğŸ“ repository/          # ä»“å‚¨æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“ service/             # æ’ä»¶æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ user/                    # ç”¨æˆ·é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ ğŸ“ entity/              # ç”¨æˆ·å®ä½“
â”‚   â”‚   â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚   â”‚   â”œâ”€â”€ ğŸ“ repository/          # ä»“å‚¨æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“ service/             # ç”¨æˆ·æœåŠ¡
â”‚   â””â”€â”€ ğŸ“ workflow/                # å·¥ä½œæµé¢†åŸŸ
â”‚       â”œâ”€â”€ ğŸ“ entity/              # å·¥ä½œæµå®ä½“
â”‚       â”‚   â””â”€â”€ ğŸ“ vo/                  # å€¼å¯¹è±¡
â”‚       â”œâ”€â”€ ğŸ“ internal/            # å†…éƒ¨å®ç°
â”‚       â”‚   â”œâ”€â”€ ğŸ“ canvas/              # ç”»å¸ƒå®ç°
â”‚       â”‚   â”œâ”€â”€ ğŸ“ compose/             # ç»„åˆå®ç°
â”‚       â”‚   â”œâ”€â”€ ğŸ“ execute/             # æ‰§è¡Œå®ç°
â”‚       â”‚   â”œâ”€â”€ ğŸ“ nodes/               # èŠ‚ç‚¹å®ç°
â”‚       â”‚   â”œâ”€â”€ ğŸ“ repo/                # ä»“å‚¨å®ç°
â”‚       â”‚   â””â”€â”€ ğŸ“ schema/              # Schema å®ç°
â”‚       â”œâ”€â”€ ğŸ“ plugin/              # å·¥ä½œæµæ’ä»¶
â”‚       â”œâ”€â”€ ğŸ“ service/             # å·¥ä½œæµæœåŠ¡
â”‚       â””â”€â”€ ğŸ“ variable/            # å·¥ä½œæµå˜é‡
â”œâ”€â”€ ğŸ“ infra/                       # åŸºç¡€è®¾æ–½å±‚
â”‚   â”œâ”€â”€ ğŸ“ contract/                # åŸºç¡€è®¾æ–½æ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“ database/            # æ•°æ®åº“æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ mysql.go                       # MySQLæ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ redis.go                       # Redisæ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ milvus.go                      # Milvusæ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“ storage/             # å­˜å‚¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ file_storage.go                # æ–‡ä»¶å­˜å‚¨æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ object_storage.go              # å¯¹è±¡å­˜å‚¨æ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“ mq/                  # æ¶ˆæ¯é˜Ÿåˆ—æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ nsq.go                         # NSQæ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“ external/            # å¤–éƒ¨æœåŠ¡æ¥å£
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ llm_provider.go                # LLMæä¾›å•†æ¥å£
â”‚   â”‚       â””â”€â”€ ğŸ“„ embedding_provider.go          # Embeddingæä¾›å•†æ¥å£
â”‚   â””â”€â”€ ğŸ“ impl/                    # åŸºç¡€è®¾æ–½å®ç°
â”‚       â”œâ”€â”€ ğŸ“ database/            # æ•°æ®åº“å®ç°
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ mysql_impl.go                  # MySQLå®ç°
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ redis_impl.go                  # Rediså®ç°
â”‚       â”‚   â””â”€â”€ ğŸ“„ milvus_impl.go                 # Milvuså®ç°
â”‚       â”œâ”€â”€ ğŸ“ storage/             # å­˜å‚¨å®ç°
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ local_storage.go               # æœ¬åœ°å­˜å‚¨å®ç°
â”‚       â”‚   â””â”€â”€ ğŸ“„ minio_storage.go               # MinIOå­˜å‚¨å®ç°
â”‚       â”œâ”€â”€ ğŸ“ mq/                  # æ¶ˆæ¯é˜Ÿåˆ—å®ç°
â”‚       â”‚   â””â”€â”€ ğŸ“„ nsq_impl.go                    # NSQå®ç°
â”‚       â””â”€â”€ ğŸ“ external/            # å¤–éƒ¨æœåŠ¡å®ç°
â”‚           â”œâ”€â”€ ğŸ“„ openai_provider.go             # OpenAIå®ç°
â”‚           â”œâ”€â”€ ğŸ“„ claude_provider.go             # Claudeå®ç°
â”‚           â””â”€â”€ ğŸ“„ gemini_provider.go             # Geminiå®ç°
â”œâ”€â”€ ğŸ“ crossdomain/                 # è·¨åŸŸæœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“ contract/                # è·¨åŸŸæœåŠ¡æ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“ knowledge/           # çŸ¥è¯†åº“è·¨åŸŸæ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“ workflow/            # å·¥ä½œæµè·¨åŸŸæ¥å£
â”‚   â””â”€â”€ ğŸ“ impl/                    # è·¨åŸŸæœåŠ¡å®ç°
â”‚       â”œâ”€â”€ ğŸ“ knowledge/           # çŸ¥è¯†åº“è·¨åŸŸå®ç°
â”‚       â””â”€â”€ ğŸ“ workflow/            # å·¥ä½œæµè·¨åŸŸå®ç°
â”œâ”€â”€ ğŸ“ pkg/                         # é€šç”¨åŒ…
â”‚   â”œâ”€â”€ ğŸ“ config/                  # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ config.go                          # é…ç½®ç»“æ„
â”‚   â”‚   â””â”€â”€ ğŸ“„ loader.go                          # é…ç½®åŠ è½½å™¨
â”‚   â”œâ”€â”€ ğŸ“ logger/                  # æ—¥å¿—ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ logger.go                          # æ—¥å¿—æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“„ zap_logger.go                      # Zapæ—¥å¿—å®ç°
â”‚   â”œâ”€â”€ ğŸ“ errors/                  # é”™è¯¯å¤„ç†
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ errors.go                          # é”™è¯¯å®šä¹‰
â”‚   â”‚   â””â”€â”€ ğŸ“„ codes.go                           # é”™è¯¯ç 
â”‚   â”œâ”€â”€ ğŸ“ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ crypto.go                          # åŠ å¯†å·¥å…·
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ json.go                            # JSONå·¥å…·
â”‚   â”‚   â””â”€â”€ ğŸ“„ validator.go                       # éªŒè¯å·¥å…·
â”‚   â””â”€â”€ ğŸ“ middleware/              # ä¸­é—´ä»¶åŒ…
â”‚       â”œâ”€â”€ ğŸ“„ recovery.go                        # æ¢å¤ä¸­é—´ä»¶
â”‚       â””â”€â”€ ğŸ“„ metrics.go                         # ç›‘æ§ä¸­é—´ä»¶
â”œâ”€â”€ ğŸ“ conf/                        # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ ğŸ“ model/                   # æ¨¡å‹é…ç½®
â”‚   â”‚   â”œâ”€â”€ ğŸ“ template/            # é…ç½®æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ openai.yaml          # OpenAIé…ç½®
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ claude.yaml          # Claudeé…ç½®
â”‚   â”‚   â””â”€â”€ ğŸ“„ gemini.yaml          # Geminié…ç½®
â”‚   â”œâ”€â”€ ğŸ“„ app.yaml                 # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ ğŸ“„ database.yaml            # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ ğŸ“„ redis.yaml               # Redisé…ç½®
â”œâ”€â”€ ğŸ“ internal/                    # å†…éƒ¨åŒ…
â”‚   â”œâ”€â”€ ğŸ“ server/                  # æœåŠ¡å™¨
â”‚   â”‚   â””â”€â”€ ğŸ“„ server.go                          # HTTPæœåŠ¡å™¨
â”‚   â””â”€â”€ ğŸ“ wire/                    # ä¾èµ–æ³¨å…¥
â”‚       â”œâ”€â”€ ğŸ“„ wire.go                            # Wireé…ç½®
â”‚       â””â”€â”€ ğŸ“„ wire_gen.go                        # ç”Ÿæˆçš„ä»£ç 
â”œâ”€â”€ ğŸ“„ main.go                      # åº”ç”¨å…¥å£
â”œâ”€â”€ ğŸ“„ go.mod                       # Goæ¨¡å—æ–‡ä»¶
â””â”€â”€ ğŸ“„ go.sum                       # Goä¾èµ–é”å®šæ–‡ä»¶
```

### åç«¯æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
graph TD
    subgraph "API Layer"
        A[Handler] --> B[Router]
        A --> C[Middleware]
    end

    subgraph "Application Layer"
        D[Knowledge Service]
        E[Agent Service]
        F[Workflow Service]
    end

    subgraph "Domain Layer"
        G[Knowledge Domain]
        H[Agent Domain]
        I[Workflow Domain]
        J[Common Domain]
    end

    subgraph "Infrastructure Layer"
        K[Database Impl]
        L[Storage Impl]
        M[MQ Impl]
        N[External Impl]
    end

    A --> D
    A --> E
    A --> F

    D --> G
    E --> H
    F --> I
    D --> J
    E --> J
    F --> J

    G --> K
    G --> L
    G --> M
    H --> K
    H --> N
    I --> K
    I --> M
```

## ğŸ”— IDL æ¥å£å®šä¹‰

```
idl/
â”œâ”€â”€ ğŸ“ data/                        # æ•°æ®ç›¸å…³æ¥å£
â”‚   â”œâ”€â”€ ğŸ“ knowledge/               # çŸ¥è¯†åº“æ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ knowledge.thrift             # çŸ¥è¯†åº“æœåŠ¡æ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ document.thrift              # æ–‡æ¡£æœåŠ¡æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“„ search.thrift                # æœç´¢æœåŠ¡æ¥å£
â”‚   â””â”€â”€ ğŸ“ common/                  # é€šç”¨æ•°æ®æ¥å£
â”‚       â”œâ”€â”€ ğŸ“„ pagination.thrift            # åˆ†é¡µæ¥å£
â”‚       â””â”€â”€ ğŸ“„ response.thrift              # å“åº”æ¥å£
â”œâ”€â”€ ğŸ“ studio/                      # å·¥ä½œå®¤ç›¸å…³æ¥å£
â”‚   â”œâ”€â”€ ğŸ“ agent/                   # AIä»£ç†æ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ agent.thrift                 # ä»£ç†æœåŠ¡æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“„ conversation.thrift          # å¯¹è¯æœåŠ¡æ¥å£
â”‚   â”œâ”€â”€ ğŸ“ workflow/                # å·¥ä½œæµæ¥å£
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ workflow.thrift              # å·¥ä½œæµæœåŠ¡æ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“„ execution.thrift             # æ‰§è¡ŒæœåŠ¡æ¥å£
â”‚   â””â”€â”€ ğŸ“ workspace/               # å·¥ä½œç©ºé—´æ¥å£
â”‚       â””â”€â”€ ğŸ“„ workspace.thrift             # å·¥ä½œç©ºé—´æœåŠ¡æ¥å£
â””â”€â”€ ğŸ“ common/                      # é€šç”¨æ¥å£
    â”œâ”€â”€ ğŸ“„ auth.thrift              # è®¤è¯æ¥å£
    â”œâ”€â”€ ğŸ“„ user.thrift              # ç”¨æˆ·æ¥å£
    â””â”€â”€ ğŸ“„ error.thrift             # é”™è¯¯æ¥å£
```

## ğŸš€ å¼€å‘è§„èŒƒ

### ä»£ç ç»„ç»‡åŸåˆ™

1. **å•ä¸€èŒè´£åŸåˆ™**: æ¯ä¸ªæ¨¡å—ã€åŒ…ã€æ–‡ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
2. **ä¾èµ–å€’ç½®åŸåˆ™**: é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œéƒ½ä¾èµ–æŠ½è±¡
3. **å¼€é—­åŸåˆ™**: å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­
4. **æ¥å£éš”ç¦»åŸåˆ™**: ä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸æ˜¯å•ä¸€çš„æ€»æ¥å£

### å‘½åè§„èŒƒ

#### å‰ç«¯å‘½åè§„èŒƒ

- **åŒ…å**: kebab-case (`knowledge-ide-base`)
- **æ–‡ä»¶å**: PascalCase for components (`KnowledgeCard.tsx`), camelCase for others (`useKnowledge.ts`)
- **ç»„ä»¶å**: PascalCase (`KnowledgeCard`)
- **å‡½æ•°å**: camelCase (`handleSearch`)
- **å¸¸é‡å**: UPPER_SNAKE_CASE (`MAX_FILE_SIZE`)

#### åç«¯å‘½åè§„èŒƒ

- **åŒ…å**: snake_case (`knowledge_service`)
- **æ–‡ä»¶å**: snake_case (`knowledge_service.go`)
- **ç»“æ„ä½“å**: PascalCase (`KnowledgeService`)
- **æ–¹æ³•å**: PascalCase (`CreateKnowledge`)
- **å˜é‡å**: camelCase (`knowledgeID`)
- **å¸¸é‡å**: PascalCase (`DefaultPageSize`)

### ç›®å½•ç»“æ„è§„èŒƒ

#### å‰ç«¯ç›®å½•è§„èŒƒ

```
package-name/
â”œâ”€â”€ ğŸ“„ package.json             # åŒ…é…ç½®æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ tsconfig.json            # TypeScripté…ç½®
â”œâ”€â”€ ğŸ“„ eslint.config.js         # ESLinté…ç½®
â”œâ”€â”€ ğŸ“„ README.md                # åŒ…è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ ğŸ“ src/                     # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ components/          # ç»„ä»¶ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ hooks/               # Hooksç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ services/            # æœåŠ¡ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ types/               # ç±»å‹å®šä¹‰ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ utils/               # å·¥å…·å‡½æ•°ç›®å½•
â”‚   â””â”€â”€ ğŸ“„ index.ts             # å¯¼å‡ºå…¥å£æ–‡ä»¶
â”œâ”€â”€ ğŸ“ tests/                   # æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ __fixtures__/        # æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ ğŸ“ __mocks__/           # Mockæ•°æ®
â”‚   â””â”€â”€ ğŸ“„ *.test.ts            # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ ğŸ“ docs/                    # æ–‡æ¡£ç›®å½•
    â””â”€â”€ ğŸ“„ README.md            # åŒ…æ–‡æ¡£
```

#### åç«¯ç›®å½•è§„èŒƒ

```
module-name/
â”œâ”€â”€ ğŸ“ entity/                  # å®ä½“ç›®å½•
â”œâ”€â”€ ğŸ“ service/                 # æœåŠ¡ç›®å½•
â”œâ”€â”€ ğŸ“ repository/              # ä»“å‚¨ç›®å½•
â”œâ”€â”€ ğŸ“ valueobject/             # å€¼å¯¹è±¡ç›®å½•
â”œâ”€â”€ ğŸ“ internal/                # å†…éƒ¨åŒ…ç›®å½•
â”œâ”€â”€ ğŸ“„ *_test.go                # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ ğŸ“„ README.md                # æ¨¡å—è¯´æ˜
```

## ğŸ“Š æµ‹è¯•ç­–ç•¥

### å‰ç«¯æµ‹è¯•ç­–ç•¥

- **Level 1**: 80% è¦†ç›–ç‡ï¼Œ90% å¢é‡è¦†ç›–ç‡
- **Level 2**: 30% è¦†ç›–ç‡ï¼Œ60% å¢é‡è¦†ç›–ç‡
- **Level 3-4**: 0% è¦†ç›–ç‡è¦æ±‚ï¼ˆçµæ´»é…ç½®ï¼‰

### åç«¯æµ‹è¯•ç­–ç•¥

- **å•å…ƒæµ‹è¯•**: æ‰€æœ‰é¢†åŸŸæœåŠ¡å’Œå®ä½“
- **é›†æˆæµ‹è¯•**: ä»“å‚¨å’Œå¤–éƒ¨æœåŠ¡æ¥å£
- **APIæµ‹è¯•**: æ‰€æœ‰HTTPæ¥å£
- **æ€§èƒ½æµ‹è¯•**: å…³é”®ä¸šåŠ¡æµç¨‹

## ğŸ”§ æ„å»ºå’Œéƒ¨ç½²

### å‰ç«¯æ„å»º

```bash
# å®‰è£…ä¾èµ–
rush update

# æ„å»ºæ‰€æœ‰åŒ…
rush build

# æ„å»ºç‰¹å®šåŒ…
rush rebuild --to @coze-apps/studio

# è¿è¡Œæµ‹è¯•
rush test

# ä»£ç æ£€æŸ¥
rush lint
```

### åç«¯æ„å»º

```bash
# æ„å»ºåç«¯æœåŠ¡
make build_server

# è¿è¡Œæµ‹è¯•
go test ./...

# ä»£ç æ£€æŸ¥
golangci-lint run

# ç”Ÿæˆä¾èµ–æ³¨å…¥ä»£ç 
wire gen ./internal/wire/
```

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®æ¶æ„æ–‡æ¡£](./project-architecture.md)
- [å¼€å‘è§„èŒƒæ–‡æ¡£](./development-guidelines.md)
- [APIæ¥å£æ–‡æ¡£](../idl/)
- [éƒ¨ç½²æŒ‡å—](./deployment-guide.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-10-27
**ç»´æŠ¤è€…**: Coze Plus Team